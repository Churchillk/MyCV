<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sear Fel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Source+Serif+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Source Serif Pro', serif;
            background: linear-gradient(135deg, #6a93cb 0%, #a4bfef 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 80px 20px 100px;
            position: relative;
            transition: background 0.5s ease;
        }
        
        .golden-border {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 12px solid transparent;
            background: linear-gradient(135deg, rgba(218, 165, 32, 0.3) 0%, rgba(255, 215, 0, 0.2) 100%);
            background-clip: padding-box;
            box-shadow: inset 0 0 20px rgba(218, 165, 32, 0.4);
            pointer-events: none;
            z-index: 100;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            perspective: 1000px;
        }
        
        .notebook {
            background: linear-gradient(to bottom, #f9f3e3, #e6ddc5);
            border-radius: 16px;
            padding: 30px 20px 50px 20px;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4), 0 0 0 6px #8b7c5a, 0 0 0 12px #e6ddc5;
            transform: rotateX(5deg);
            transition: transform 0.5s ease;
            border: 1px solid rgba(139, 124, 90, 0.3);
        }
        
        .notebook:hover {
            transform: rotateX(0deg);
        }
        
        .notebook::before {
            content: "";
            position: absolute;
            top: 0;
            left: 45px;
            height: 100%;
            width: 3px;
            background: linear-gradient(to bottom, #ff6b6b, #ff8e8e, #ff6b6b);
        }
        
        .spiral {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 35px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10px;
        }
        
        .hole {
            width: 14px;
            height: 14px;
            background: #8b7c5a;
            border-radius: 50%;
            margin: 10px 0;
            box-shadow: inset 0 0 0 2px #6d6147, 0 0 5px rgba(0,0,0,0.2);
            position: relative;
        }
        
        .hole::after {
            content: "";
            position: absolute;
            top: 3px;
            left: 3px;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
        }
        
        .page {
            background-color: rgba(255, 251, 240, 0.95);
            padding: 35px 25px 35px 55px;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.05);
            min-height: 70vh;
        }
        
        .page::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 40px;
            background: linear-gradient(to right, rgba(179, 19, 18, 0.1), transparent);
        }
        
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 8rem;
            opacity: 0.03;
            color: #5d4037;
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            pointer-events: none;
            z-index: 0;
        }
        
        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: #5d4037;
            text-align: center;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
            padding: 0 20px;
            z-index: 2;
        }
        
        h1::after {
            content: "";
            position: absolute;
            bottom: -8px;
            left: 10%;
            width: 80%;
            height: 2px;
            background: linear-gradient(to right, transparent, #5d4037, transparent);
        }
        
        .poem {
            font-size: 1.1rem;
            white-space: pre-line;
            position: relative;
            z-index: 2;
        }
        
        .line {
            margin-bottom: 18px;
            opacity: 0;
            animation: fadeIn 0.4s forwards;
            position: relative;
            padding-left: 8px;
            border-left: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .line.visible {
            opacity: 1;
        }
        
        .line:hover {
            border-left: 2px solid #ff6b6b;
            transform: translateX(5px);
            background: rgba(255, 255, 240, 0.7);
        }
        
        .highlight {
            background: linear-gradient(120deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1));
            padding: 0 3px;
            border-radius: 2px;
            font-weight: 600;
        }
        
        .emoji {
            position: absolute;
            font-size: 2.2rem;
            z-index: 10;
            opacity: 0;
            pointer-events: none;
            filter: drop-shadow(3px 3px 3px rgba(0,0,0,0.2));
        }
        
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
        
        @keyframes popInOut {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.8) rotate(-10deg);
            }
            20% {
                opacity: 1;
                transform: translateY(0) scale(1.2) rotate(0deg);
            }
            80% {
                opacity: 1;
                transform: translateY(-15px) scale(1.1) rotate(5deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-30px) scale(0.9) rotate(10deg);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            33% {
                transform: translateY(-10px) rotate(-3deg);
            }
            66% {
                transform: translateY(5px) rotate(3deg);
            }
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .cursor {
            display: inline-block;
            width: 8px;
            height: 1.2em;
            background-color: #5d4037;
            margin-left: 4px;
            animation: blink 1s infinite;
            vertical-align: middle;
            border-radius: 2px;
        }
        
        @keyframes blink {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0;
            }
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            position: fixed;
            top: 20px;
            left: 0;
            width: 100%;
            z-index: 1000;
            padding: 0 20px;
        }
        
        .btn {
            background: linear-gradient(to bottom, #8b7c5a, #6d6147);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Source Serif Pro', serif;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn:hover {
            background: linear-gradient(to bottom, #5d4037, #4a3329);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }
        
        .btn:active {
            transform: translateY(1px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        }
        
        .theme-controls {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 15px;
            position: fixed;
            bottom: 20px;
            left: 0;
            width: 100%;
            z-index: 1000;
            padding: 0 20px;
        }
        
        .theme-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid white;
            cursor: pointer;
            box-shadow: 0 3px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .theme-btn::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: scale(0);
            transition: transform 0.3s ease;
        }
        
        .theme-btn:hover::after {
            transform: scale(1);
        }
        
        .theme-btn:hover {
            transform: scale(1.15);
        }
        
        .theme-default { background: linear-gradient(135deg, #f5ecd2 0%, #e6ddc5 100%); }
        .theme-blue { background: linear-gradient(135deg, #e6f2ff 0%, #c5e1e6 100%); }
        .theme-pink { background: linear-gradient(135deg, #ffe6f2 0%, #e6c5d5 100%); }
        .theme-green { background: linear-gradient(135deg, #e6ffe6 0%, #c5e6c5 100%); }
        
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(to bottom, #8b7c5a, #6d6147);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .writing-sound {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }
        
        .pen-icon {
            position: absolute;
            bottom: 25px;
            right: 25px;
            font-size: 2.2rem;
            color: #5d4037;
            opacity: 0.7;
            animation: float 5s ease-in-out infinite;
            filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));
        }
        
        .progress-container {
            width: 100%;
            height: 6px;
            background: rgba(139, 124, 90, 0.3);
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
            position: fixed;
            top: 70px;
            left: 0;
            width: 100%;
            padding: 0 20px;
            z-index: 1000;
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #8b7c5a, #5d4037);
            border-radius: 10px;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(93, 64, 55, 0.5);
        }
        
        .save-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(to bottom, #8b7c5a, #6d6147);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .save-notification {
            position: fixed;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(93, 64, 55, 0.95);
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            opacity: 0;
            transition: opacity 0.3s ease;
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .save-notification.show {
            opacity: 1;
        }
        
        .line-number {
            position: absolute;
            left: -25px;
            color: #8b7c5a;
            font-size: 0.8rem;
            opacity: 0.7;
            font-weight: 600;
        }
        
        /* Premium decorative elements */
        .corner-decoration {
            position: absolute;
            width: 30px;
            height: 30px;
            z-index: 5;
        }
        
        .corner-tl {
            top: 10px;
            left: 10px;
            border-top: 2px solid #8b7c5a;
            border-left: 2px solid #8b7c5a;
        }
        
        .corner-tr {
            top: 10px;
            right: 10px;
            border-top: 2px solid #8b7c5a;
            border-right: 2px solid #8b7c5a;
        }
        
        .corner-bl {
            bottom: 10px;
            left: 10px;
            border-bottom: 2px solid #8b7c5a;
            border-left: 2px solid #8b7c5a;
        }
        
        .corner-br {
            bottom: 10px;
            right: 10px;
            border-bottom: 2px solid #8b7c5a;
            border-right: 2px solid #8b7c5a;
        }
        
        /* Responsive adjustments */
        @media (max-width: 500px) {
            body {
                padding: 80px 15px 100px;
            }
            
            .notebook {
                padding: 25px 15px 40px 15px;
            }
            
            .page {
                padding: 30px 20px 30px 45px;
                min-height: 65vh;
            }
            
            .poem {
                font-size: 1rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .notebook::before {
                left: 40px;
            }
            
            .watermark {
                font-size: 6rem;
            }
            
            .controls {
                padding: 0 15px;
            }
            
            .theme-controls {
                padding: 0 15px;
            }
        }
        
        @media (max-width: 380px) {
            .btn {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .btn i {
                font-size: 0.9rem;
            }
            
            .theme-btn {
                width: 32px;
                height: 32px;
            }
            
            .sound-toggle, .save-btn {
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>
<body class="theme-default">
    <div class="golden-border"></div>
    
    <div class="container">
        <div class="notebook">
            <div class="spiral">
                <div class="hole"></div>
                <div class="hole"></div>
                <div class="hole"></div>
                <div class="hole"></div>
                <div class="hole"></div>
                <div class="hole"></div>
            </div>
            
            <div class="page">
                <div class="corner-decoration corner-tl"></div>
                <div class="corner-decoration corner-tr"></div>
                <div class="corner-decoration corner-bl"></div>
                <div class="corner-decoration corner-br"></div>
                
                <div class="watermark">POETRY</div>
                
                <h1>Jack of All Trades 🥀</h1>
                <div class="poem"></div>
                
                <i class="fas fa-pen-fancy pen-icon"></i>
            </div>
        </div>
    </div>
    
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    
    <div class="controls">
        <button class="btn" id="restartBtn">
            <i class="fas fa-redo"></i> <span>Restart</span>
        </button>
        <button class="btn" id="pauseBtn">
            <i class="fas fa-pause"></i> <span>Pause</span>
        </button>
        <button class="btn" id="speedBtn">
            <i class="fas fa-tachometer-alt"></i> <span>Speed: 1x</span>
        </button>
    </div>
    
    <div class="theme-controls">
        <div class="theme-btn theme-default" data-theme="default"></div>
        <div class="theme-btn theme-blue" data-theme="blue"></div>
        <div class="theme-btn theme-pink" data-theme="pink"></div>
        <div class="theme-btn theme-green" data-theme="green"></div>
    </div>
    
    <div class="sound-toggle">
        <i class="fas fa-volume-mute"></i>
    </div>
    
    <div class="save-btn">
        <i class="fas fa-download"></i>
    </div>
    
    <div class="save-notification" id="saveNotification">
        <i class="fas fa-check"></i> Poem saved to your device
    </div>
    
    <audio class="writing-sound" loop>
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-writing-on-notebook-2581.mp3" type="audio/mpeg">
    </audio>

    <script>
        const poemLines = [
            {text: "Sear Divya,\nFirst—", delay: 800},
            {text: "I'm not cold ❄️...", delay: 1000, emoji: "❄️", emojiCount: 2, emotion: "cold"},
            {text: "but if that's the name you give me,", delay: 1200},
            {text: "then maybe it fits,", delay: 1000},
            {text: "in the way a coat fits on a stormy night.", delay: 1500, emoji: "🌧️", emojiCount: 3, emotion: "storm"},
            
            {text: "Second—", delay: 800},
            {text: "I missed my step that morning ☀️,", delay: 1200, emoji: "☀️", emojiCount: 2, emotion: "sunny"},
            {text: "your words deserved more than just", delay: 1200},
            {text: "\"thank you & amen.\"", delay: 1000},
            {text: "My bad—", delay: 800},
            {text: "I know.", delay: 800, emoji: "😔", emojiCount: 2, emotion: "apology"},
            
            {text: "You want to learn what makes me happy 💭,", delay: 1500, emoji: "💭", emojiCount: 2, emotion: "thought"},
            {text: "yet when I try to unwrap myself,", delay: 1200},
            {text: "you tell me \"shut up\",", delay: 1000, emoji: "😶", emojiCount: 2, emotion: "silenced"},
            {text: "or ask \"sasa umeanza kuwa personal?\"", delay: 1500},
            {text: "It feels like the poet in you 🌹", delay: 1200, emoji: "🌹", emojiCount: 2, emotion: "poetic"},
            {text: "and the real you ⚡ clash sometimes.", delay: 1200, emoji: "⚡", emojiCount: 2, emotion: "conflict"},
            {text: "I like the poet more—", delay: 1000},
            {text: "the calm ink that flows,", delay: 1000},
            {text: "not the bossy storm.", delay: 1000, emoji: "🌪️", emojiCount: 2, emotion: "chaos"},
            
            {text: "If roles were reversed—", delay: 1000},
            {text: "would you bear it?", delay: 800},
            {text: "Me shutting your voice down", delay: 1000},
            {text: "while you're trying to be seen?", delay: 1000, emoji: "👁️", emojiCount: 2, emotion: "seen"},
            {text: "Maybe you do listen,", delay: 800},
            {text: "maybe you don't...", delay: 1000, emoji: "🤔", emojiCount: 2, emotion: "contemplation"},
            {text: "but silence has its weight too.", delay: 1200, emoji: "🔇", emojiCount: 2, emotion: "silence"},
            
            {text: "I know I don't say much.", delay: 1000},
            {text: "You call it cold,", delay: 800},
            {text: "sometimes even problem (jokingly).", delay: 1200},
            {text: "But if I am the problem 🪞,", delay: 1200, emoji: "🪞", emojiCount: 2, emotion: "reflection"},
            {text: "tell me—", delay: 600},
            {text: "what solution are you bringing?", delay: 1200, emoji: "❓", emojiCount: 3, emotion: "question"},
            {text: "Because I like your company,", delay: 1000},
            {text: "and I walk careful—", delay: 800},
            {text: "never trying to offend.", delay: 1000, emoji: "🚶‍♂️", emojiCount: 2, emotion: "careful"},
            
            {text: "You think you've known me forever,", delay: 1200},
            {text: "because I've been an open book 📖", delay: 1200, emoji: "📖", emojiCount: 2, emotion: "book"},
            {text: "with missing chapters.", delay: 1000, emoji: "📑", emojiCount: 2, emotion: "missing"},
            {text: "Truth is,", delay: 600},
            {text: "no one can ever love enough.", delay: 1200, emoji: "💔", emojiCount: 2, emotion: "heartbreak"},
            {text: "Not me, not you.", delay: 800},
            {text: "But together—", delay: 800},
            {text: "we can figure things out.", delay: 1200, emoji: "🤝", emojiCount: 2, emotion: "together"},
            
            {text: "What makes me happy?", delay: 800},
            {text: "Peace of mind 🌌.", delay: 1000, emoji: "🌌", emojiCount: 3, emotion: "peace"},
            {text: "That's why I'm always alone.", delay: 1200, emoji: "🧘‍♂️", emojiCount: 2, emotion: "alone"},
            {text: "It's not arguments I fear—", delay: 1000},
            {text: "I never called it that.", delay: 800},
            {text: "I just share my thoughts,", delay: 800},
            {text: "my feelings,", delay: 600},
            {text: "because you asked me to speak.", delay: 1200},
            {text: "But when I do—", delay: 800},
            {text: "you turn away,", delay: 800, emoji: "😞", emojiCount: 2, emotion: "sad"},
            {text: "and I wonder... what's the point?", delay: 1500, emoji: "💭", emojiCount: 3, emotion: "wondering"},
            
            {text: "Still, thank you ❤️,", delay: 1000, emoji: "❤️", emojiCount: 3, emotion: "love"},
            {text: "for caring enough to be afraid.", delay: 1200, emoji: "🙏", emojiCount: 2, emotion: "grateful"},
            {text: "Meeting you was no accident—", delay: 1200},
            {text: "a pleasure I can't deny.", delay: 1000, emoji: "😊", emojiCount: 2, emotion: "happy"},
            
            {text: "I also want to know you.", delay: 1000},
            {text: "But I'm built different,", delay: 800},
            {text: "just as you are 🌙.", delay: 1000, emoji: "🌙", emojiCount: 2, emotion: "moon"},
            {text: "Sometimes tough,", delay: 600, emoji: "🪨", emojiCount: 1, emotion: "tough"},
            {text: "sometimes soft.", delay: 600, emoji: "🛏️", emojiCount: 1, emotion: "soft"},
            {text: "Sometimes right,", delay: 600, emoji: "✅", emojiCount: 1, emotion: "right"},
            {text: "sometimes wrong.", delay: 600, emoji: "❌", emojiCount: 1, emotion: "wrong"},
            {text: "All I ask—", delay: 600},
            {text: "accept that balance.", delay: 800, emoji: "⚖️", emojiCount: 2, emotion: "balance"},
            {text: "Because peace is my love language 💎,", delay: 1500, emoji: "💎", emojiCount: 3, emotion: "diamond"},
            {text: "and without it,", delay: 600},
            {text: "love is just noise.", delay: 1000, emoji: "🔊", emojiCount: 3, emotion: "noise"}
        ];
        
        const poemContainer = document.querySelector('.poem');
        const restartBtn = document.getElementById('restartBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const speedBtn = document.getElementById('speedBtn');
        const soundToggle = document.querySelector('.sound-toggle');
        const writingSound = document.querySelector('.writing-sound');
        const themeButtons = document.querySelectorAll('.theme-btn');
        const saveBtn = document.querySelector('.save-btn');
        const saveNotification = document.getElementById('saveNotification');
        const progressBar = document.getElementById('progressBar');
        
        let currentThemeIndex = 0;
        const themes = ['theme-default', 'theme-blue', 'theme-pink', 'theme-green'];
        let timeouts = [];
        let isPaused = false;
        let currentLine = 0;
        let soundEnabled = false;
        let speedMultiplier = 1;
        let speedOptions = [0.5, 1, 1.5, 2];
        let currentSpeedIndex = 1;
        
        function typePoem(startFrom = 0) {
            // Clear any existing timeouts if starting from beginning
            if (startFrom === 0) {
                timeouts.forEach(timeout => clearTimeout(timeout));
                timeouts = [];
                poemContainer.innerHTML = '';
                currentLine = 0;
                progressBar.style.width = '0%';
            }
            
            let cumulativeDelay = 0;
            
            // Create all lines up to current point (for resume)
            for (let i = 0; i < startFrom; i++) {
                const lineElement = createLineElement(i);
                poemContainer.appendChild(lineElement);
            }
            
            // Process remaining lines
            for (let i = startFrom; i < poemLines.length; i++) {
                cumulativeDelay += poemLines[i].delay;
                
                const timeoutId = setTimeout(() => {
                    if (isPaused) {
                        currentLine = i; // Remember where we paused
                        return;
                    }
                    
                    const lineElement = createLineElement(i);
                    poemContainer.appendChild(lineElement);
                    
                    // Update progress bar
                    progressBar.style.width = `${((i + 1) / poemLines.length) * 100}%`;
                    
                    // Make line visible
                    setTimeout(() => {
                        lineElement.classList.add('visible');
                    }, 10);
                    
                    if (poemLines[i].emoji) {
                        for (let j = 0; j < (poemLines[i].emojiCount || 2); j++) {
                            createEmoji(poemLines[i].emoji, lineElement, poemLines[i].emotion);
                        }
                    }
                    
                    // Scroll to keep the current line in view
                    setTimeout(() => {
                        lineElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 100);
                    
                }, cumulativeDelay / speedMultiplier);
                
                timeouts.push(timeoutId);
            }
            
            // Add blinking cursor at the end
            const cursorTimeout = setTimeout(() => {
                if (isPaused) return;
                
                const cursor = document.createElement('div');
                cursor.classList.add('cursor');
                poemContainer.appendChild(cursor);
                
                if (soundEnabled) {
                    writingSound.pause();
                }
            }, cumulativeDelay / speedMultiplier + 500);
            
            timeouts.push(cursorTimeout);
            
            // Start writing sound if enabled
            if (soundEnabled && startFrom === 0) {
                writingSound.currentTime = 0;
                writingSound.play();
            } else if (soundEnabled) {
                writingSound.play();
            }
        }
        
        function createLineElement(index) {
            const lineElement = document.createElement('div');
            lineElement.classList.add('line');
            
            // Add line number
            const lineNumber = document.createElement('span');
            lineNumber.classList.add('line-number');
            lineNumber.textContent = index + 1;
            lineElement.appendChild(lineNumber);
            
            // Add text with some words highlighted
            const text = poemLines[index].text;
            const words = text.split(' ');
            let highlightedText = '';
            
            // Randomly highlight some words for emphasis
            words.forEach(word => {
                if (Math.random() > 0.8 && word.length > 3 && !word.includes('—') && !word.includes('?')) {
                    highlightedText += `<span class="highlight">${word}</span> `;
                } else {
                    highlightedText += `${word} `;
                }
            });
            
            lineElement.innerHTML += highlightedText;
            return lineElement;
        }
        
        function createEmoji(emoji, parentElement, emotion) {
            const emojiElement = document.createElement('div');
            emojiElement.classList.add('emoji');
            emojiElement.innerHTML = emoji;
            emojiElement.dataset.emotion = emotion || 'neutral';
            
            // Random position around the text
            const leftPos = Math.random() * 80 + 10; // 10% to 90%
            const topPos = Math.random() * 100;
            
            emojiElement.style.left = `${leftPos}%`;
            emojiElement.style.top = `${topPos}%`;
            
            // Different animations based on emotion
            if (emotion === 'love' || emotion === 'happy') {
                emojiElement.style.animation = `heartbeat ${1 + Math.random() * 0.5}s ease-in-out forwards, popInOut ${2 + Math.random() * 1}s ease-in-out forwards`;
            } else {
                emojiElement.style.animation = `popInOut ${2 + Math.random() * 1}s ease-in-out forwards`;
            }
            
            parentElement.appendChild(emojiElement);
            
            // Remove emoji after animation completes
            setTimeout(() => {
                if (emojiElement.parentNode) {
                    emojiElement.remove();
                }
            }, 3000);
        }
        
        function changeTheme(theme) {
            const body = document.body;
            
            // Remove all themes
            themes.forEach(t => body.classList.remove(t));
            
            // Apply new theme
            body.classList.add(theme);
        }
        
        function toggleSound() {
            soundEnabled = !soundEnabled;
            
            if (soundEnabled) {
                soundToggle.innerHTML = '<i class="fas fa-volume-up"></i>';
                if (!isPaused) {
                    writingSound.play();
                }
            } else {
                soundToggle.innerHTML = '<i class="fas fa-volume-mute"></i>';
                writingSound.pause();
            }
        }
        
        function togglePause() {
            isPaused = !isPaused;
            
            if (isPaused) {
                // Pause the animation
                timeouts.forEach(timeout => clearTimeout(timeout));
                pauseBtn.innerHTML = '<i class="fas fa-play"></i> <span>Resume</span>';
                writingSound.pause();
            } else {
                // Resume from current line
                pauseBtn.innerHTML = '<i class="fas fa-pause"></i> <span>Pause</span>';
                typePoem(currentLine);
                
                if (soundEnabled) {
                    writingSound.play();
                }
            }
        }
        
        function changeSpeed() {
            currentSpeedIndex = (currentSpeedIndex + 1) % speedOptions.length;
            speedMultiplier = speedOptions[currentSpeedIndex];
            speedBtn.innerHTML = `<i class="fas fa-tachometer-alt"></i> <span>Speed: ${speedMultiplier}x</span>`;
            
            if (!isPaused) {
                // Restart with new speed
                togglePause();
                togglePause();
            }
        }
        
        function savePoem() {
            const poemText = poemLines.map(line => line.text).join('\n');
            const blob = new Blob([poemText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'jack-of-all-trades-poem.txt';
            document.body.appendChild(a);
            a.click();
            
            // Clean up
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
            
            // Show notification
            saveNotification.classList.add('show');
            setTimeout(() => {
                saveNotification.classList.remove('show');
            }, 3000);
        }
        
        // Event listeners
        restartBtn.addEventListener('click', () => {
            isPaused = false;
            pauseBtn.innerHTML = '<i class="fas fa-pause"></i> <span>Pause</span>';
            typePoem(0);
        });
        
        pauseBtn.addEventListener('click', togglePause);
        
        speedBtn.addEventListener('click', changeSpeed);
        
        soundToggle.addEventListener('click', toggleSound);
        
        saveBtn.addEventListener('click', savePoem);
        
        themeButtons.forEach(button => {
            button.addEventListener('click', () => {
                changeTheme(`theme-${button.dataset.theme}`);
            });
        });
        
        // Start the typing effect when page loads
        window.onload = () => typePoem(0);
    </script>
</body>
</html>
